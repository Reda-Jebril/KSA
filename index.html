 <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحليل تفاعلي لعمق شروخ الأسفلت في السعودية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #FDFBF7;
            color: #3D352E;
        }
        .bg-primary { background-color: #FDFBF7; }
        .bg-secondary { background-color: #F4EFE6; }
        .bg-accent { background-color: #E68A00; }
        .text-accent { color: #E68A00; }
        .border-accent { border-color: #E68A00; }
        .active-nav {
            color: #E68A00;
            border-bottom: 2px solid #E68A00;
            padding-bottom: 4px;
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
            padding-bottom: 4px;
            display: inline-flex;
            align-items: center;
        }
        .nav-link:hover {
            color: #E68A00;
        }
        .nav-link .icon {
            margin-left: 6px;
        }
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
        .source-item {
            word-wrap: break-word; /* Ensures long text wraps */
            overflow-wrap: break-word; /* Modern equivalent */
        }
    </style>
</head>
<body class="bg-primary">

    <nav id="navbar" class="bg-primary/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-accent">تحليل شروخ الأسفلت</h1>
            <div class="hidden md:flex items-center space-x-8 lg:space-x-10 text-lg">
                <a href="#hero" class="nav-link active-nav"><span class="icon">🏠</span>الرئيسية</a>
                <a href="#crack-types" class="nav-link"><span class="icon">🚧</span>أنواع الشروخ</a>
                <a href="#factors" class="nav-link"><span class="icon">⚙️</span>العوامل المؤثرة</a>
                <a href="#depth" class="nav-link"><span class="icon">📊</span>تقديرات العمق</a>
                <a href="#recommendations" class="nav-link"><span class="icon">💡</span>التوصيات</a>
                <a href="#sources" class="nav-link"><span class="icon">📚</span>المصادر</a>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-3xl text-gray-700">☰</button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-primary shadow-lg">
            <a href="#hero" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">🏠</span> الرئيسية</a>
            <a href="#crack-types" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">🚧</span> أنواع الشروخ</a>
            <a href="#factors" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">⚙️</span> العوامل المؤثرة</a>
            <a href="#depth" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">📊</span> تقديرات العمق</a>
            <a href="#recommendations" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">💡</span> التوصيات</a>
            <a href="#sources" class="block text-center py-3 px-4 text-lg hover:bg-secondary"><span class="icon">📚</span> المصادر</a>
        </div>
    </nav>

    <main>
        <section id="hero" class="py-20 md:py-32">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl md:text-6xl font-bold mb-4">أقصى عمق محتمل للشروخ</h2>
                <h3 class="text-2xl md:text-4xl font-semibold text-accent mb-8">في الرصفات الأسفلتية السعودية</h3>
                <p class="max-w-3xl mx-auto text-lg md:text-xl text-gray-700 leading-relaxed">
                    تواجه الطرق في المملكة العربية السعودية تحديات فريدة بسبب المناخ القاسي والأحمال المرورية العالية، مما يؤدي إلى ظهور شروخ يمكن أن تصل إلى أعماق كبيرة. هذا التطبيق التفاعلي يحلل البيانات من تقرير فني لتبسيط فهم هذه الظاهرة المعقدة.
                </p>
                <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                    <div class="bg-secondary p-6 rounded-xl shadow-md">
                        <p class="text-4xl font-bold text-accent">72°م</p>
                        <p class="mt-2 text-lg">أقصى حرارة لسطح الرصفة</p>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl shadow-md">
                        <p class="text-4xl font-bold text-accent">25+ سم</p>
                        <p class="mt-2 text-lg">عمق محتمل للشروخ في الطرق السريعة</p>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl shadow-md">
                        <p class="text-4xl font-bold text-accent">5+</p>
                        <p class="mt-2 text-lg">عوامل رئيسية مؤثرة</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="crack-types" class="py-20 bg-secondary">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold">أنواع الشروخ الرئيسية</h2>
                    <p class="mt-4 text-lg max-w-2xl mx-auto text-gray-700">لكل نوع من الشروخ مظهر وسبب وآلية انتشار مختلفة، مما يؤثر على العمق الذي يمكن أن يصل إليه. انقر على أي بطاقة لمعرفة المزيد.</p>
                </div>
                <div id="crack-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
            </div>
        </section>

        <section id="factors" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold">العوامل الأساسية المؤثرة</h2>
                    <p class="mt-4 text-lg max-w-2xl mx-auto text-gray-700">عمق الشروخ ليس نتيجة لعامل واحد، بل هو تفاعل معقد بين الظروف البيئية، الأحمال، خصائص المواد، وحالة التربة.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 text-center">
                    <div class="bg-secondary p-6 rounded-xl">
                        <div class="text-5xl mb-4">🚚</div>
                        <h3 class="text-xl font-bold mb-2">الأحمال المرورية</h3>
                        <p>الأحمال الثقيلة والمتكررة تسبب إجهادًا يؤدي إلى "شروخ الكلال" التي تبدأ من الأسفل وتنتشر لكامل العمق.</p>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl">
                        <div class="text-5xl mb-4">☀️🌡️</div>
                        <h3 class="text-xl font-bold mb-2">العوامل البيئية</h3>
                        <p>تقلبات الحرارة العالية تسبب "شروخًا حرارية"، بينما تسرّع الحرارة القصوى من تقادم الأسفلت وهشاشته.</p>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl">
                        <div class="text-5xl mb-4">🧱</div>
                        <h3 class="text-xl font-bold mb-2">خصائص المواد</h3>
                        <p>جودة المادة الرابطة، تصميم الخلطة، وسماكة طبقة الأسفلت تحدد مقاومة الرصفة للتشقق.</p>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl">
                        <div class="text-5xl mb-4">🌱</div>
                        <h3 class="text-xl font-bold mb-2">التربة الأساسية</h3>
                        <p>ضعف التربة (مثل السبخة) يقلل الدعم ويسرّع من وصول الشروخ إلى أعماق كبيرة، ممتدة أحيانًا إلى طبقات الأساس.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="depth" class="py-20 bg-secondary">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold">مقارنة تقديرات أقصى عمق للشروخ</h2>
                    <p class="mt-4 text-lg max-w-3xl mx-auto text-gray-700">
                        هذا المخطط يوضح أقصى عمق محتمل لمختلف أنواع الشروخ. يمكنك التبديل بين سيناريو "الطرق السريعة" (ذات طبقات أسفلتية أسمك) و"الطرق الزراعية" (ذات طبقات أرق) لملاحظة الفرق.
                    </p>
                </div>
                <div class="flex justify-center mb-8 space-x-4">
                    <button id="highway-btn" class="px-6 py-2 text-lg font-semibold rounded-md transition-all duration-300 bg-accent text-white shadow-lg">الطرق السريعة</button>
                    <button id="rural-btn" class="px-6 py-2 text-lg font-semibold rounded-md transition-all duration-300 bg-gray-300 text-gray-800">الطرق الزراعية</button>
                </div>
                <div class="chart-container">
                    <canvas id="depthChart"></canvas>
                </div>
                <div id="chart-context" class="mt-8 text-center bg-primary p-4 rounded-xl shadow-inner max-w-3xl mx-auto min-h-[50px]">
                    <p class="text-gray-600">مرر الفأرة فوق أحد الأعمدة في المخطط لعرض معلومات إضافية.</p>
                </div>
            </div>
        </section>

        <section id="recommendations" class="py-20">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold">التوصيات الرئيسية للحد من الشروخ</h2>
                    <p class="mt-4 text-lg max-w-2xl mx-auto text-gray-700">يتطلب التحكم في عمق الشروخ نهجاً شاملاً يمتد من التصميم إلى الصيانة.</p>
                </div>
                <div id="accordion-container" class="max-w-4xl mx-auto space-y-4">
                </div>
            </div>
        </section>

        <section id="sources" class="py-20 bg-secondary">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold">المصادر والمراجع</h2>
                    <p class="mt-4 text-lg max-w-2xl mx-auto text-gray-700">
                        قائمة بالمصادر العلمية والتقارير التي تم الاعتماد عليها في إعداد هذا التحليل. انقر على أي مصدر للاطلاع عليه (سيفتح في نافذة جديدة). 
                        <strong class="text-red-600">ملاحظة هامة: الروابط أدناه هي روابط نائبة حاليًا لأن التقرير الأصلي لم يوفر روابط URL فعلية. يرجى استبدال `[رابط المصدر الفعلي هنا - رقم المرجع]` بالروابط الفعلية والدقيقة لمصادرك.</strong>
                    </p>
                </div>
                <div id="sources-list" class="max-w-3xl mx-auto space-y-4">
                    <!-- المصادر سيتم إضافتها هنا بواسطة جافاسكريبت -->
                </div>
                 <p class="text-center text-gray-600 mt-6">ملاحظة: هذه قائمة بالمصادر المذكورة في التقرير الفني. يرجى الرجوع إلى المصادر الأصلية للحصول على المعلومات الكاملة والمفصلة.</p>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white py-10">
        <div class="container mx-auto px-6 text-center">
            <p>تم إنشاء هذا التطبيق التفاعلي لتسهيل فهم تقرير "أقصى عمق محتمل للشروخ في الرصفات الأسفلتية المرنة بالمملكة العربية السعودية".</p>
            <p class="mt-2 text-sm text-gray-400">جميع البيانات مأخوذة من التقرير الفني المرجعي.</p>
            <p class="mt-4 text-sm text-gray-300">تصميم: آلاء يحيى</p>
        </div>
    </footer>

    <div id="modal-container" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 modal-overlay opacity-0 pointer-events-none">
        <div id="modal-content" class="bg-primary rounded-xl shadow-2xl p-8 max-w-2xl w-full relative transform scale-95 transition-transform duration-300">
            <button id="modal-close-btn" class="absolute top-4 left-4 text-3xl font-bold text-gray-500 hover:text-gray-800">×</button>
            <div id="modal-body"></div>
        </div>
    </div>
    
    <script>
        const crackData = [
            { id: 'fatigue', icon: '🌐', name: 'شروخ الكلال (التمساحية)', description: 'سلسلة من الشروخ المترابطة تشبه جلد التمساح، ناتجة عن الأحمال المرورية المتكررة. تبدأ عادةً من أسفل الطبقة الإسفلتية وتنتشر للأعلى.', cause: 'فشل الكلال (التعب) تحت تأثير الأحمال المرورية العالية والمتكررة.' },
            { id: 'thermal', icon: '❄️', name: 'الشروخ الحرارية (المستعرضة)', description: 'شروخ تمتد بشكل عمودي على محور الطريق، ناتجة عن انكماش الأسفلت بسبب البرودة أو تصلب المادة الرابطة مع الزمن.', cause: 'التقلبات الحرارية الكبيرة وتقادم المادة الرابطة الإسفلتية.' },
            { id: 'longitudinal', icon: '↔️', name: 'الشروخ الطولية', description: 'شروخ تمتد بشكل موازٍ لمحور الطريق. أسبابها متعددة وقد تكون مرتبطة بالأحمال، فواصل الرصف، أو عوامل حرارية.', cause: 'سوء تنفيذ فواصل الرصف، انكماش حراري، أو قد تكون مرحلة مبكرة من شروخ الكلال.' },
            { id: 'block', icon: '🧱', name: 'شروخ الكتل', description: 'شبكة من الشروخ تقسم الرصفة إلى قطع مستطيلة كبيرة. تحدث بسبب انكماش الأسفلت نتيجة التقادم ودورات الحرارة اليومية.', cause: 'تقادم المادة الرابطة والتغيرات الحجمية اليومية بسبب الحرارة (غير مرتبطة بالحمولة).' },
            { id: 'reflection', icon: '🔄', name: 'الشروخ الانعكاسية', description: 'شروخ تظهر في طبقة التغطية الجديدة وتعكس نمط الشروخ أو الفواصل الموجودة في الطبقة القديمة تحتها.', cause: 'حركة (حرارية أو بسبب الأحمال) في الطبقة القديمة أسفل طبقة التغطية.' },
            { id: 'edge', icon: '📐', name: 'شروخ الحواف', description: 'شروخ طولية تظهر قرب حافة الرصفة، خاصة في الطرق التي لا تحتوي على أكتاف مرصوفة.', cause: 'ضعف الدعم الجانبي من الأكتاف، ضعف الدمك عند الحواف، وتسرب المياه.' }
        ];

        const depthData = {
            highway: {
                labels: ['شروخ الكلال', 'الشروخ الحرارية', 'الشروخ الطولية (حمولة)', 'شروخ من الأعلى للأسفل', 'شروخ الحواف', 'شروخ الكتل'],
                depths: [25, 25, 25, 15, 25, 8],
                contexts: [
                    'في الطرق السريعة، يمكن أن تصل شروخ الكلال إلى كامل عمق الطبقات الإسفلتية (25 سم أو أكثر) بسبب الأحمال الثقيلة.',
                    'التقلبات الحرارية الكبيرة والتقادم السريع للأسفلت في السعودية يمكن أن يؤدي إلى انتشار الشروخ الحرارية لكامل عمق الرصفة.',
                    'عندما تكون مرتبطة بالحمولة، تتصرف كشروخ الكلال ويمكن أن تصل إلى كامل العمق الإنشائي.',
                    'في الرصفات السميكة، قد تبدأ هذه الشروخ من السطح وتخترق لأعماق كبيرة (10-15 سم) وقد تصل لكامل العمق بمرور الوقت.',
                    'مع ضعف الدعم الجانبي، يمكن أن يتدهور كامل سمك الرصفة عند الحافة.',
                    'عادةً ما تكون سطحية، لكن مع التقادم الشديد يمكن أن تتعمق، وإن كان من غير المرجح أن تصل لكامل عمق طبقة سميكة.'
                ]
            },
            rural: {
                labels: ['شروخ الكلال', 'الشروخ الحرارية', 'الشروخ الطولية (حمولة)', 'شروخ من الأعلى للأسفل', 'شروخ الحواف', 'شروخ الكتل'],
                depths: [13, 13, 13, 10, 13, 6],
                contexts: [
                    'في الطرق الزراعية ذات الطبقات الأرق، تصل شروخ الكلال بسرعة إلى كامل العمق (13 سم) إذا كانت الأحمال موجودة.',
                    'تصل الشروخ الحرارية أيضًا إلى كامل العمق في الرصفات الرقيقة بسهولة أكبر.',
                    'في الرصفات الرقيقة، أي شرخ طولي مرتبط بالحمولة سيخترق كامل الطبقة.',
                    'هذه الآلية أقل شيوعًا في الرصفات الرقيقة، ولكن إذا حدثت، فإنها تتعمق بسرعة.',
                    'انهيار الحافة يؤثر على كامل عمق الرصفة الرقيقة.',
                    'تظل شروخ الكتل محصورة بشكل أكبر في الطبقة السطحية.'
                ]
            }
        };

        const recommendationsData = [
            { title: 'توصيات التصميم', content: 'استخدام مواد رابطة معدلة بالبوليمر لمقاومة الحرارة والتقادم. تصميم خلطات إسفلتية متوازنة تقاوم التخدد والتشقق. تحسين خصائص التربة الأساسية (خاصة السبخة) وتوفير نظام صرف فعال. معالجة الشروخ القديمة قبل وضع أي طبقات تغطية جديدة لمنع الانعكاس.' },
            { title: 'توصيات التنفيذ', content: 'الالتزام الصارم بالمواصفات الفنية. تحقيق الدمك الكافي والمطلوب لجميع الطبقات، مع التركيز على الحواف والفواصل الطولية. المراقبة الدقيقة لدرجات حرارة الخلطة الإسفلتية أثناء الفرش والدمك لضمان المتانة.' },
            { title: 'توصيات الصيانة', content: 'تطبيق برامج صيانة وقائية واستباقية، مثل الختم المبكر للشروخ لمنع تسرب المياه وتفاقمها. استخدام تقنيات متقدمة لتقييم حالة الرصف وتحديد أولويات الصيانة. التحقيق في الأسباب الجذرية للشروخ العميقة (عبر العينات اللبية) قبل الإصلاح.' }
        ];

        const reportSources = [
            { number: 11, title: "ACRP Pavement Tool. (n.d.). Distresses.", details: "Texas A&M Transportation Institute." },
            { number: 12, title: "ACRP Pavement Tool. (n.d.). Browse Full List.", details: "Texas A&M Transportation Institute." },
            { number: 1, title: "Yin, H., Soltani, A., & Liu, C. (2010). Opening-Mode Cracking in Asphalt Pavements.", details: "Road Materials and Pavement Design, 11(4), 843-860." },
            { number: 34, title: "Zhang, J., Liu, P., & Zhang, L. (2023). Fracture Characteristics and Acoustic Emission Signal Analysis of Asphalt Mixtures with Different Gradations under Various Loading Rates.", details: "Journal of Materials in Civil Engineering, 35(10), MTENG-16270." },
            { number: 13, title: "Strata Global. (2023, October 26). What Factors Affect Pavement Life: Understanding Cracking.", details: "" },
            { number: 17, title: "California Department of Transportation (Caltrans). (n.d.). Common Flexible Pavement Distresses.", details: "MTAG." },
            { number: 20, title: "مستند بعنوان \"التشققات في الطبقة الاسفلتية واسبابها\". (2020, April 10).", details: "Scribd." },
            { number: 15, title: "مدونة \"رصف الطرق بالاسفلت\". (n.d.). أنواع الرصفات والعوامل المؤثرة في تصميمها.", details: "" },
            { number: 9, title: "قناة \"هندسة الطرق والجسور\". (2021, January 2). أنواع التشققات في الطرق الأسفلتية وأسبابها وطرق علاجها.", details: "YouTube." },
            { number: 35, title: "موقع الخيمة، قسم الهندسة. (n.d.). الشروخ في المنشآت الخرسانية.", details: "" },
            { number: 21, title: "Asphalt Pavement Association of Washington (WAPA). (n.d.). Top-Down Cracking.", details: "" },
            { number: 22, title: "Pavement Interactive. (n.d.). Top-Down Cracking.", details: "" },
            { number: 2, title: "Strata Global. (n.d.). Fatigue Cracking.", details: "Glossary." },
            { number: 14, title: "Unique Paving Materials. (2023, February 21). What is Fatigue Cracking in Pavement?", details: "" },
            { number: 5, title: "Kaloush, K., et al. (n.d.). Assessment of Thermal and Durability Cracks in Asphalt Pavements in the Southwest Region.", details: "Arizona State University, Sustainable Pavement & UMTRA Research Center (SPARC)." },
            { number: 16, title: "Asphalt Pavement Association of Washington (WAPA). (n.d.). Transverse (Thermal) Cracking.", details: "" },
            { number: 18, title: "Austroads. (2024, September 3). Evaluation of a Prediction Procedure for Pavement Reflective Cracking.", details: "" },
            { number: 19, title: "Federal Aviation Administration (FAA). (n.d.). Reflective Cracking Program.", details: "Airport Technology R&D Branch." },
            { number: 32, title: "بوابة منطقة الرياض. (n.d.). النقل.", details: "" },
            { number: 3, title: "Noureldin, A. S., & Al-Dhalaan, M. A. (1995). Premature Rutting of Asphalt Concrete Pavements in Saudi Arabia.", details: "Transportation Research Record, 1473, 36-43." },
            { number: 6, title: "موقع \"طرقكم لمقاولات الأسفلت\". (n.d.). مشاكل تشققات الأسفلت: الأسباب وطرق المعالجة.", details: "" },
            { number: 27, title: "وزارة المالية، المملكة العربية السعودية. (1428هـ). نموذج عقد تشغيل وصيانة الطرق.", details: "" },
            { number: 28, title: "وزارة الشؤون البلدية والقروية والإسكان، المملكة العربية السعودية. (التاريخ غير متوفر). أداة الإصدار + دليل التصميم الهندسي للطرق.", details: "" },
            { number: 29, title: "أمانة العاصمة المقدسة. (التاريخ غير متوفر). دليل التصميم الهندسي للطرق.", details: "" },
            { number: 30, title: "وزارة الشؤون البلدية والقروية والإسكان، المملكة العربية السعودية. (التاريخ غير متوفر). أداة الإصدار + دليل فحص وتقييم وصيانة الجسور ومنشآت الطرق والرصف.", details: "" },
            { number: 31, title: "الهيئة الوطنية للمواصفات والمقاييس والجودة (NCC). (التاريخ غير متوفر). كود الطرق السعودي 501 - نظم إدارة صيانة الرصف.", details: "" },
            { number: 26, title: "Majidifard, H., Jahangiri, B., Rath, P., Akbari, M., & Buttlar, W. G. (2020). Deep Machine Learning Approach to Develop a New Asphalt Pavement Condition Index.", details: "Construction and Building Materials, 247, 118513." },
            { number: 36, title: "Al-Gahtani, K., et al. (2022). Rehabilitation of Shaybah Airport Runway Using Rubblization Technology.", details: "Open Journal of Civil Engineering, 12(2), 239-255." },
            { number: 37, title: "Owusu-Ababio, S., & Schmitt, R. L. (2021). Machine Learning Approach to Predict IRI Based on Pavement Distress Data.", details: "Applied Sciences, 11(19), 9081." },
            { number: 38, title: "Al-Omari, R. R. (2010). Damaging Effect of Tank Loads on Flexible Pavements.", details: "Journal of Engineering, 16(3), 5517-5531." },
            { number: 39, title: "Khan, M. A. A., et al. (2022). Impact of Temperature on Asphalt Pavement: A Review.", details: "Yildiz Technical University Journal of Civil Engineering and Architecture, 7(2), 221-230." },
            { number: 4, title: "Wahhab, H. I. A., & Khan, Z. A. (1994). Manifestation of Temperature Variation of Flexible and Rigid Pavements in Dhahran, Saudi Arabia.", details: "King Abdulaziz University: Engineering Sciences, 6(2), 477-490." },
            { number: 7, title: "Al-Homidy, A. A., et al. (2019). Influence of Using Emulsified Sulfur Asphalt on Engineering Properties of Cold Mixes with Different Types of Soil.", details: "Journal of Southwest Jiaotong University, 54(4). [تم تعديل المرجع ليشير إلى محتوى مشابه حول تأثير السبخة]" },
            { number: 8, title: "Al-Amoudi, O. S. B., et al. (2014). Stabilization of Sabkha Soil using Cement and Cement Bypass Dust.", details: "Jurnal Teknologi, 70(7), 103-109." },
            { number: 10, title: "Al-Khateeb, G. G., Ksaibati, K., & Zeiada, W. (2021). Implementation of AASHTOWare Pavement ME Design in Saudi Arabia.", details: "Arizona State University Library." },
            { number: 40, title: "Noureldin, A. S. (1994). Variability of Design Factors for Flexible Pavements in Saudi Arabia.", details: "King Abdulaziz University: Engineering Sciences, 6(2), 529-540." },
            { number: 25, title: "Hossain, K., Karakas, A., & Alqarni, A. (2024). A Critical Review of Asphalt Binder Modification: From Material Perspective to Environmental Considerations.", details: "Materials, 17(10), 2312." },
            { number: 33, title: "Khan, A. A., et al. (2019). Performance Evaluation of SUPERPAVE Mixture Modified with Epolene (EE-2) for Alfaraa Campus (King Khalid University) Abha, Saudi Arabia.", details: "Materials Science-Poland, 37(3), 476-483." },
            { number: 41, title: "Rahman, M. T., et al. (2022). Application of Mechanistic Empirical Pavement Design Guide Software in Saudi Arabia.", details: "Buildings, 12(8), 1102." },
            { number: 23, title: "صحيفة الوطن. (2020, نوفمبر 11). مواصفات الطرق.", details: "" },
            { number: 24, title: "Al-Dubabe, I. A. S. (2000). Polymer Modification of Arab Asphalt to Suit Gulf Countries Performance Requirements (Doctoral dissertation, King Fahd University of Petroleum and Minerals).", details: "" }
        ];


        document.addEventListener('DOMContentLoaded', () => {
            const crackCardsContainer = document.getElementById('crack-cards-container');
            crackData.forEach(crack => {
                const card = document.createElement('div');
                card.className = 'card bg-primary p-6 rounded-xl shadow-md cursor-pointer text-center';
                card.innerHTML = `
                    <div class="text-5xl mb-4">${crack.icon}</div>
                    <h3 class="text-xl font-bold">${crack.name}</h3>
                `;
                card.addEventListener('click', () => openModal(crack));
                crackCardsContainer.appendChild(card);
            });

            const accordionContainer = document.getElementById('accordion-container');
            recommendationsData.forEach((rec, index) => {
                const item = document.createElement('div');
                item.className = 'border border-gray-200 rounded-lg overflow-hidden';
                item.innerHTML = `
                    <button class="accordion-header w-full text-right p-4 bg-secondary hover:bg-gray-200 flex justify-between items-center transition">
                        <span class="font-semibold text-lg">${rec.title}</span>
                        <span class="accordion-icon text-2xl font-light transform transition-transform">+</span>
                    </button>
                    <div class="accordion-content bg-primary">
                        <p class="p-4 text-gray-700 leading-relaxed">${rec.content}</p>
                    </div>
                `;
                accordionContainer.appendChild(item);
            });

            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const icon = header.querySelector('.accordion-icon');
                    
                    document.querySelectorAll('.accordion-content').forEach(c => {
                        if (c !== content) {
                            c.style.maxHeight = null;
                            if (c.previousElementSibling) {
                                const prevIcon = c.previousElementSibling.querySelector('.accordion-icon');
                                if (prevIcon) {
                                    prevIcon.textContent = '+';
                                    prevIcon.classList.remove('rotate-45');
                                }
                            }
                        }
                    });

                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        icon.textContent = '+';
                        icon.classList.remove('rotate-45');
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                        icon.textContent = '+';
                        icon.classList.add('rotate-45');
                    }
                });
            });

            const modalContainer = document.getElementById('modal-container');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalContent = document.getElementById('modal-content');
            
            function openModal(crack) {
                const modalBody = document.getElementById('modal-body');
                modalBody.innerHTML = `
                    <h2 class="text-3xl font-bold mb-4 text-accent">${crack.name}</h2>
                    <p class="text-lg mb-4 text-gray-800">${crack.description}</p>
                    <hr class="my-4">
                    <h3 class="text-xl font-semibold mb-2">السبب الرئيسي:</h3>
                    <p class="text-lg text-gray-700">${crack.cause}</p>
                `;
                modalContainer.classList.remove('opacity-0', 'pointer-events-none');
                modalContent.classList.remove('scale-95');
            }

            function closeModal() {
                modalContainer.classList.add('opacity-0');
                modalContent.classList.add('scale-95');
                setTimeout(() => {
                    modalContainer.classList.add('pointer-events-none');
                }, 300);
            }

            modalCloseBtn.addEventListener('click', closeModal);
            modalContainer.addEventListener('click', (e) => {
                if (e.target === modalContainer) {
                    closeModal();
                }
            });

            const ctx = document.getElementById('depthChart').getContext('2d');
            let depthChart;
            const chartContext = document.getElementById('chart-context');

            function createOrUpdateChart(roadType) {
                const data = depthData[roadType];
                const chartTitle = roadType === 'highway' ? 'أقصى عمق محتمل (سم) - الطرق السريعة' : 'أقصى عمق محتمل (سم) - الطرق الزراعية';
                const maxDepth = roadType === 'highway' ? 30 : 15;

                if (depthChart) {
                    depthChart.data.labels = data.labels;
                    depthChart.data.datasets[0].data = data.depths;
                    depthChart.options.scales.x.max = maxDepth; // Use scales.x for Chart.js v3+
                    depthChart.options.plugins.title.text = chartTitle;
                    depthChart.update();
                } else {
                    depthChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data.labels,
                            datasets: [{
                                label: 'أقصى عمق (سم)',
                                data: data.depths,
                                backgroundColor: 'rgba(230, 138, 0, 0.6)',
                                borderColor: 'rgba(230, 138, 0, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: { // Changed from xAxes to x for Chart.js v3+
                                    beginAtZero: true,
                                    max: maxDepth,
                                    title: {
                                        display: true,
                                        text: 'العمق (سم)',
                                        font: { size: 14, family: 'Tajawal' }
                                    },
                                    ticks: {
                                        font: { family: 'Tajawal' }
                                    }
                                },
                                y: { // Changed from yAxes to y for Chart.js v3+
                                    ticks: {
                                        font: { size: 12, family: 'Tajawal' }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                title: {
                                    display: true,
                                    text: chartTitle,
                                    font: { size: 18, family: 'Tajawal' },
                                    padding: { top: 10, bottom: 20 }
                                },
                                tooltip: {
                                    enabled: true,
                                    bodyFont: { family: 'Tajawal' },
                                    titleFont: { family: 'Tajawal' },
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.x !== null) {
                                                label += context.parsed.x + ' سم';
                                            }
                                            return label;
                                        }
                                    }
                                }
                            },
                            onHover: (event, chartElement) => {
                                if (chartElement.length > 0) {
                                    const index = chartElement[0].index;
                                    chartContext.innerHTML = `<p class="text-gray-800 font-semibold">${data.labels[index]}:</p><p class="text-gray-700">${data.contexts[index]}</p>`;
                                } else {
                                     chartContext.innerHTML = `<p class="text-gray-600">مرر الفأرة فوق أحد الأعمدة في المخطط لعرض معلومات إضافية.</p>`;
                                }
                            }
                        }
                    });
                }
            }

            const highwayBtn = document.getElementById('highway-btn');
            const ruralBtn = document.getElementById('rural-btn');

            highwayBtn.addEventListener('click', () => {
                createOrUpdateChart('highway');
                highwayBtn.classList.add('bg-accent', 'text-white', 'shadow-lg');
                highwayBtn.classList.remove('bg-gray-300', 'text-gray-800');
                ruralBtn.classList.add('bg-gray-300', 'text-gray-800');
                ruralBtn.classList.remove('bg-accent', 'text-white', 'shadow-lg');
            });

            ruralBtn.addEventListener('click', () => {
                createOrUpdateChart('rural');
                ruralBtn.classList.add('bg-accent', 'text-white', 'shadow-lg');
                ruralBtn.classList.remove('bg-gray-300', 'text-gray-800');
                highwayBtn.classList.add('bg-gray-300', 'text-gray-800');
                highwayBtn.classList.remove('bg-accent', 'text-white', 'shadow-lg');
            });
            
            createOrUpdateChart('highway'); // Initialize chart

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const navLinks = document.querySelectorAll('#navbar a[href^="#"]');
            const sections = document.querySelectorAll('main section');
            
            function updateActiveNav() {
                let current = 'hero'; 
                const navHeight = document.getElementById('navbar').offsetHeight;
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - navHeight - 20) { 
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active-nav');
                    if (link.getAttribute('href').substring(1) === current) {
                        link.classList.add('active-nav');
                    }
                });

                const mobileNavLinks = document.querySelectorAll('#mobile-menu a[href^="#"]');
                 mobileNavLinks.forEach(link => {
                    link.classList.remove('bg-accent', 'text-white', 'font-semibold');
                     link.classList.add('hover:bg-secondary');
                    if (link.getAttribute('href').substring(1) === current) {
                        link.classList.add('bg-accent', 'text-white', 'font-semibold');
                        link.classList.remove('hover:bg-secondary');
                    }
                })
            }

            window.addEventListener('scroll', updateActiveNav);
            updateActiveNav(); // Initial call
            
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId && targetId.length > 1 && targetId.startsWith('#')) { 
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                             const navHeight = document.getElementById('navbar').offsetHeight;
                             const offsetTop = targetElement.offsetTop - navHeight;
                             window.scrollTo({
                                top: offsetTop,
                                behavior: 'smooth'
                            });
                        }
                    }
                    if (mobileMenu.classList.contains('hidden') === false) {
                        mobileMenu.classList.add('hidden');
                    }
                });
            });

            // Populate sources
            const sourcesListContainer = document.getElementById('sources-list');
            if (sourcesListContainer) {
                 // Sort by original report number, then by title if numbers are missing or same
                const sortedSources = reportSources.sort((a, b) => {
                    if (a.number && b.number) {
                        return a.number - b.number;
                    } else if (a.number) {
                        return -1; // a comes first if it has a number and b doesn't
                    } else if (b.number) {
                        return 1; // b comes first if it has a number and a doesn't
                    }
                    return a.title.localeCompare(b.title); // Fallback to title sort
                });

                sortedSources.forEach(source => {
                    const linkElement = document.createElement('a');
                    linkElement.href = `[رابط المصدر الفعلي هنا - ${source.number || 'غير مرقم'}]`; // Placeholder URL
                    linkElement.target = "_blank";
                    linkElement.rel = "noopener noreferrer";
                    linkElement.className = "source-item block p-5 bg-primary rounded-xl shadow-md hover:shadow-lg transition-shadow text-accent hover:text-orange-700";
                    
                    const titleElement = document.createElement('h4');
                    titleElement.className = "text-xl font-semibold mb-1";
                    titleElement.textContent = `${source.number ? source.number + '. ' : ''}${source.title}`;
                    
                    linkElement.appendChild(titleElement);
                    
                    if (source.details && source.details.trim() !== "") {
                        const detailsElement = document.createElement('p');
                        detailsElement.className = "text-sm text-gray-600";
                        detailsElement.textContent = source.details;
                        linkElement.appendChild(detailsElement);
                    }
                    
                    sourcesListContainer.appendChild(linkElement);
                });
            }

        });
    </script>

</body>
